<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bloody — Техподдержка</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #e30707;
            --bg: #0b0b0b;
            --card: #151515;
            --input: #222;
            --text-gray: #888;
        }

        body {
            background-color: var(--bg);
            background-image: radial-gradient(circle at top right, #1a0505 0%, #0b0b0b 100%);
            color: white;
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            padding-bottom: 50px;
        }

        .container { max-width: 1000px; margin-top: 40px; }

        h1 {
            font-weight: 900;
            color: var(--primary);
            text-transform: uppercase;
            text-align: center;
            margin-bottom: 40px;
            letter-spacing: 3px;
            text-shadow: 0 0 15px rgba(227, 7, 7, 0.4);
        }

        /* Кнопка назад */
        .nav-header { margin-bottom: 20px; }
        .btn-back {
            color: var(--text-gray);
            text-decoration: none;
            font-size: 0.9rem;
            transition: 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-back:hover { color: var(--primary); }

        /* FAQ Блок */
        .faq-section {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid #222;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .faq-item { margin-bottom: 10px; cursor: pointer; }
        .faq-item summary { font-weight: 600; color: #ccc; padding: 5px; }
        .faq-item summary:hover { color: var(--primary); }

        /* Форма вопроса */
        .support-form {
            background: var(--card);
            border: 1px solid #333;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            margin-bottom: 40px;
        }

        .form-control {
            background: var(--input);
            border: 1px solid #333;
            color: white;
            border-radius: 10px;
                        padding: 15px;
        }
        .form-control:focus {
            background: #2a2a2a;
            color: white;
            border-color: var(--primary);
            box-shadow: 0 0 10px rgba(227, 7, 7, 0.3);
        }

        .btn-bloody {
            background: var(--primary);
            border: none;
            color: white;
            font-weight: 800;
            padding: 12px 30px;
            border-radius: 10px;
            text-transform: uppercase;
            transition: 0.3s;
            width: 100%;
        }
        .btn-bloody:hover {
            background: #ff0000;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(227, 7, 7, 0.5);
        }

        /* Карточки вопросов */
        .question-item {
            background: var(--card);
            border: 1px solid #222;
            border-radius: 18px;
            padding: 25px;
            margin-bottom: 25px;
            position: relative;
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-badge {
            font-size: 0.7rem;
            padding: 3px 10px;
            border-radius: 50px;
            text-transform: uppercase;
            font-weight: 800;
            margin-bottom: 10px;
            display: inline-block;
        }
        .status-waiting { background: #333; color: #888; }
        .status-solved { background: rgba(40, 167, 69, 0.1); color: #28a745; border: 1px solid #28a745; }

        .question-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #efefef;
        }

        .answer-list {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 3px solid var(--primary);
        }

        .answer-item {
            font-size: 0.95rem;
            color: #bbb;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #222;
            position: relative;
        }
        .answer-item:last-child { border: 0; margin: 0; padding: 0; }

        .btn-del {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: #444;
            transition: 0.3s;
        }
        .btn-del:hover { color: var(--primary); }

        .answer-input-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .answer-input-group input { flex: 1; }
        .answer-input-group button { width: auto; font-size: 0.8rem; }

        .time { font-size: 0.75rem; color: #444; display: block; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-header">
        <a href="index.html" class="btn-back"><i class="fas fa-arrow-left"></i> На главную</a>
    </div>

    <h1>Центр поддержки</h1>

    <div class="row g-4">
        <!-- ФОРМА И FAQ -->
        <div class="col-lg-4">
            <div class="support-form">
                <h5 class="mb-3">Новый тикет</h5>
                <form id="questionForm">
                    <textarea id="questionText" class="form-control mb-3" rows="4" placeholder="Опишите вашу проблему..." required></textarea>
                    <button type="submit" class="btn-bloody">Отправить тикет</button>
                </form>
            </div>

            <div class="faq-section">
                <h6 class="mb-3 text-white"><i class="fas fa-info-circle me-2"></i> База знаний</h6>
                <details class="faq-item">
                    <summary>Условия пользования</summary>
                    <div class="small text-muted p-2">C условиями пользования маркетплейса Bloody вы можете ознакомиться тут <a  href="delet.html">Условия пользования</a></div>
                </details>
                <details class="faq-item">
                    <summary>Где мой товар?</summary>
                    <div class="small text-muted p-2">Все товары приходят в "Личный кабинет" после оплаты.</div>
                </details>
                <details class="faq-item">
                    <summary>Как вернуть деньги?</summary>
                    <div class="small text-muted p-2">Возврат невозможен, если товар уже был выдан.</div>
                </details>
            </div>
        </div>

        <!-- СПИСОК ВОПРОСОВ -->
        <div class="col-lg-8">
            <div id="questionsContainer">
                <!-- Сюда JS вставит вопросы -->
            </div>
        </div>
    </div>
</div>

<script>
    const questionForm = document.getElementById('questionForm');
    const questionsContainer = document.getElementById('questionsContainer');

    function save(data) { localStorage.setItem('bloodySupport', JSON.stringify(data)); }
    function load() { return JSON.parse(localStorage.getItem('bloodySupport')) || []; }

    function render() {
        const questions = load();
        if (questions.length === 0) {
            questionsContainer.innerHTML = `
                <div class="text-center py-5">
                    <i class="fas fa-headset fa-3x mb-3 text-muted" style="opacity:0.2"></i>
                    <p class="text-muted">У вас пока нет активных обращений</p>
                </div>`;
            return;
        }

        questionsContainer.innerHTML = questions.map((q, qIdx) => {
            const isSolved = q.answers.length > 0;
            return `
                <div class="question-item">
                    <button class="btn-del" onclick="deleteQ(${qIdx})"><i class="fas fa-trash"></i></button>
                    <span class="status-badge ${isSolved ? 'status-solved' : 'status-waiting'}">
                        ${isSolved ? 'Решено' : 'В обработке'}
                    </span>
                    <div class="question-text">${q.text}</div>
                    <span class="time">Создано: ${q.date}</span>

                    <div class="answer-list">
                        ${q.answers.length > 0 ? q.answers.map((ans, aIdx) => `
                            <div class="answer-item">
                                <span class="text-white d-block mb-1">Менеджер Bloody:</span>
                                ${ans}
                                <button class="btn-del p-0" style="font-size:0.7rem; top:0" onclick="deleteA(${qIdx}, ${aIdx})">Удалить</button>
                            </div>
                        `).join('') : '<em>Ожидайте ответа специалиста...</em>'}
                    </div>

                    <form class="answer-input-group mt-3" onsubmit="addA(event, ${qIdx})">
                        <input type="text" class="form-control form-control-sm" placeholder="Ответить (админ)...">
                        <button type="submit" class="btn-bloody" style="width: auto">Отправить</button>
                    </form>
                </div>
            `;
        }).join('');
    }

    // Создать вопрос
    questionForm.onsubmit = (e) => {
        e.preventDefault();
        const text = document.getElementById('questionText').value.trim();
        const data = load();
        data.unshift({
            text: text,
            date: new Date().toLocaleString('ru-RU'),
            answers: []
        });
        save(data);
        document.getElementById('questionText').value = '';
        render();
    };

    // Добавить ответ
    window.addA = (e, qIdx) => {
        e.preventDefault();
        const input = e.target.querySelector('input');
        const text = input.value.trim();
        if (!text) return;
        
        const data = load();
        data[qIdx].answers.push(text);
        save(data);
        render();
    };

    // Удалить вопрос
    window.deleteQ = (idx) => {
        if(confirm('Удалить обращение?')) {
            const data = load();
            data.splice(idx, 1);
            save(data);
            render();
        }
    };

    // Удалить ответ
    window.deleteA = (qIdx, aIdx) => {
        const data = load();
        data[qIdx].answers.splice(aIdx, 1);
        save(data);
        render();
    };

    render();
</script>

</body>
</html>